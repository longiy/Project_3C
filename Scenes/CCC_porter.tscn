[gd_scene format=3 uid="uid://fvx54iskoapx"]

[ext_resource type="Script" uid="uid://d3c3d101qoirc" path="res://Scripts/Character/CharacterController.gd" id="1_d6jmh"]
[ext_resource type="Script" uid="uid://dkck14xrr3k1x" path="res://Scripts/Camera/CameraSystem.gd" id="1_nfwqg"]
[ext_resource type="Script" uid="uid://dvoxu6frkwrwi" path="res://Scripts/Camera/CameraDelay.gd" id="2_d6jmh"]
[ext_resource type="Script" uid="uid://dtxx8xlsewsfv" path="res://Scripts/Control/InputConfig.gd" id="2_lcxqd"]
[ext_resource type="Script" uid="uid://thel4dd2jygm" path="res://Scripts/Camera/CameraZoom.gd" id="3_7ehud"]
[ext_resource type="Script" uid="uid://dkqykiqarykxi" path="res://Scripts/Camera/CameraRotaion.gd" id="4_q20ws"]
[ext_resource type="PackedScene" uid="uid://dhfpmbmq55xqo" path="res://Assets/Porter/PorterMain.tscn" id="5_ie3xu"]
[ext_resource type="Script" uid="uid://dga1kxck5v62n" path="res://Scripts/Control/InputCoordinator.gd" id="6_uj5ul"]
[ext_resource type="Script" uid="uid://cndsnej173wka" path="res://Scripts/IK/FootIKController.gd" id="7_w56hs"]
[ext_resource type="Resource" uid="uid://ba6hbu0x8bufx" path="res://Scripts/Control/InputConfig_A.tres" id="7_ws850"]
[ext_resource type="Script" uid="uid://bh16mnck8a2vm" path="res://Scripts/Character/MovementSystem.gd" id="9_rsiw4"]
[ext_resource type="Script" uid="uid://bkv8he7g4u73k" path="res://Scripts/Character/MovementConfig.gd" id="10_lcxqd"]
[ext_resource type="Script" uid="uid://dib1jwwb3fxyn" path="res://Scripts/Character/MovementDebugVisualizer.gd" id="14_vfsic"]

[sub_resource type="Resource" id="Resource_nfwqg"]
script = ExtResource("2_lcxqd")
metadata/_custom_type_script = "uid://dtxx8xlsewsfv"

[sub_resource type="PrismMesh" id="PrismMesh_wa4a6"]
size = Vector3(0.1, 0.1, 0.1)

[sub_resource type="SphereShape3D" id="SphereShape3D_12gup"]
radius = 0.1

[sub_resource type="CapsuleMesh" id="CapsuleMesh_rsiw4"]
radius = 0.2
height = 1.7

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_w56hs"]
radius = 0.29052734

[sub_resource type="Resource" id="Resource_w56hs"]
script = ExtResource("10_lcxqd")
jump_height = 0.5
metadata/_custom_type_script = "uid://bkv8he7g4u73k"

[node name="CccPorter" type="Node3D" unique_id=1352496923 node_paths=PackedStringArray("character_body", "camera_system", "input_coordinator", "movement_system")]
script = ExtResource("1_d6jmh")
input_config = SubResource("Resource_nfwqg")
character_body = NodePath("CharacterBody3D")
camera_system = NodePath("CameraSystem")
input_coordinator = NodePath("InputCoordinator")
movement_system = NodePath("MovementSystem")

[node name="CameraLeadTarget" type="MeshInstance3D" parent="." unique_id=1823057798]
mesh = SubResource("PrismMesh_wa4a6")
skeleton = NodePath("../CameraSystem")

[node name="CameraSystem" type="Node3D" parent="." unique_id=1595390908 node_paths=PackedStringArray("delay_system", "zoom_system", "rotation_system", "spring_arm", "camera", "target_object")]
script = ExtResource("1_nfwqg")
delay_system = NodePath("CameraDelay")
zoom_system = NodePath("CameraZoom")
rotation_system = NodePath("CameraRotation")
spring_arm = NodePath("SpringArm3D")
camera = NodePath("SpringArm3D/CameraRig/Camera3D")
target_object = NodePath("../CharacterBody3D")

[node name="CameraDelay" type="Node" parent="CameraSystem" unique_id=529403415 node_paths=PackedStringArray("target_visualization")]
script = ExtResource("2_d6jmh")
target_visualization = NodePath("../../CameraLeadTarget")

[node name="CameraZoom" type="Node" parent="CameraSystem" unique_id=1789304894]
script = ExtResource("3_7ehud")

[node name="CameraRotation" type="Node" parent="CameraSystem" unique_id=1369526738]
script = ExtResource("4_q20ws")

[node name="SpringArm3D" type="SpringArm3D" parent="CameraSystem" unique_id=878119015]
collision_mask = 2
shape = SubResource("SphereShape3D_12gup")
margin = 1.0

[node name="CameraRig" type="Node3D" parent="CameraSystem/SpringArm3D" unique_id=148238117]

[node name="Camera3D" type="Camera3D" parent="CameraSystem/SpringArm3D/CameraRig" unique_id=1747627618]
v_offset = 0.5

[node name="CharacterBody3D" type="CharacterBody3D" parent="." unique_id=1252911616 node_paths=PackedStringArray("skeleton", "character_body", "fabrik_left", "fabrik_right", "ik_target_left", "ik_target_right", "raycast_left", "raycast_right") groups=["player"]]
collision_layer = 3
floor_block_on_wall = false
floor_max_angle = 2.6179938
script = ExtResource("7_w56hs")
skeleton = NodePath("PorterMain/Porter/rig/Skeleton3D")
character_body = NodePath(".")
fabrik_left = NodePath("PorterMain/Porter/rig/Skeleton3D/FABRIK_LefLeg")
fabrik_right = NodePath("PorterMain/Porter/rig/Skeleton3D/FABRIK_RightLeg")
ik_target_left = NodePath("PorterMain/IKTargetLeft")
ik_target_right = NodePath("PorterMain/IKTargetRight")
raycast_left = NodePath("FootRayLeft")
raycast_right = NodePath("FootRayRight")
skeleton_lerp_speed = 1.0

[node name="CapsulePreview" type="MeshInstance3D" parent="CharacterBody3D" unique_id=419172217]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.85, 0)
visible = false
mesh = SubResource("CapsuleMesh_rsiw4")

[node name="CapsuleCollider" type="CollisionShape3D" parent="CharacterBody3D" unique_id=1559916990]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -0.12864394)
shape = SubResource("CapsuleShape3D_w56hs")
debug_color = Color(0, 0.6, 0.69803923, 0.8745098)

[node name="PorterMain" parent="CharacterBody3D" unique_id=686191924 instance=ExtResource("5_ie3xu")]

[node name="Skeleton3D" parent="CharacterBody3D/PorterMain/Porter/rig" parent_id_path=PackedInt32Array(686191924, 81651980) index="0" unique_id=1782406787]
bones/18/position = Vector3(0.15951495, 1.3456192, -0.027196717)
bones/18/rotation = Quaternion(-0.14518961, -0.07298705, 0.979691, -0.11746637)
bones/18/scale = Vector3(1.0000001, 1, 1)
bones/19/rotation = Quaternion(-6.7654216e-17, 5.7742e-08, 5.58794e-09, 1)
bones/19/scale = Vector3(0.99999994, 1.0000001, 1.0000002)
bones/20/rotation = Quaternion(0.15972856, 4.824005e-07, 4.7403507e-08, 0.98716104)
bones/20/scale = Vector3(0.99999994, 0.9999996, 0.9999995)
bones/21/rotation = Quaternion(-6.798655e-08, -7.031489e-08, 3.725275e-09, 1)
bones/21/scale = Vector3(0.99999994, 1, 0.9999999)
bones/22/rotation = Quaternion(-0.06327868, 0.000782346, 0.012337075, 0.9979194)
bones/22/scale = Vector3(0.9999998, 0.9999997, 0.99999976)
bones/24/position = Vector3(-0.15951504, 1.345619, -0.02719673)
bones/24/rotation = Quaternion(0.14518963, -0.07298612, 0.97969115, 0.11746637)
bones/24/scale = Vector3(1.0000001, 0.99999994, 1)
bones/25/rotation = Quaternion(2.04891e-08, 5.5879347e-08, 6.891784e-08, 1)
bones/25/scale = Vector3(1.0000004, 1.0000002, 1.0000001)
bones/26/rotation = Quaternion(0.15972674, -6.0742025e-07, 8.265343e-08, 0.98716134)
bones/26/scale = Vector3(0.9999995, 0.9999999, 0.9999998)
bones/27/rotation = Quaternion(-1.3038531e-08, 5.1688417e-08, 5.2154064e-08, 1)
bones/27/scale = Vector3(0.99999994, 0.99999964, 1)
bones/28/rotation = Quaternion(-0.06327774, -0.0007823048, -0.012337247, 0.99791944)
bones/28/scale = Vector3(1, 1, 0.99999964)

[node name="AnimationTree" parent="CharacterBody3D/PorterMain/Porter" parent_id_path=PackedInt32Array(686191924, 1438479390) index="1" unique_id=787079905 node_paths=PackedStringArray("movement_system")]
movement_system = NodePath("../../../../MovementSystem")

[node name="FootRayLeft" type="RayCast3D" parent="CharacterBody3D" unique_id=414805567]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.15, 0, 0)

[node name="FootRayRight" type="RayCast3D" parent="CharacterBody3D" unique_id=1308032402]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.15, 0, 0)

[node name="InputCoordinator" type="Node" parent="." unique_id=563899000]
script = ExtResource("6_uj5ul")
input_config = ExtResource("7_ws850")

[node name="MovementSystem" type="Node" parent="." unique_id=1988730838 node_paths=PackedStringArray("character_body", "camera_pivot")]
script = ExtResource("9_rsiw4")
movement_config = SubResource("Resource_w56hs")
character_body = NodePath("../CharacterBody3D")
camera_pivot = NodePath("../CameraSystem/SpringArm3D/CameraRig/Camera3D")

[node name="MovementDebugVisualizer" type="Node" parent="MovementSystem" unique_id=944442921]
script = ExtResource("14_vfsic")
enable_debug_vectors = true

[editable path="CharacterBody3D/PorterMain"]
